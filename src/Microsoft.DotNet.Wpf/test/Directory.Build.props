<Project>
  <Import Condition="Exists('../Directory.Build.props')" Project="../Directory.Build.props" />
  
  <PropertyGroup>
    <WpfTestBasePath>$(MsBuildThisFileDirectory)</WpfTestBasePath>
    <DrtCommonRoot>$(WpfTestBasePath)\Common\DRT</DrtCommonRoot>
    <WpfSharedRoot>$(WpfTestBasePath)\Shared</WpfSharedRoot>
    <PublishRoot>$(RepoRoot)artifacts\test\</PublishRoot>

    <TargetFramework>netcoreapp3.0</TargetFramework>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>

    <MicrosoftSourceLinkVersion>1.0.0-beta2-18618-05</MicrosoftSourceLinkVersion>
  </PropertyGroup>
  
  <Choose>
    <When Condition="'$(Platform)' == 'x64'">
      <PropertyGroup>
        <RuntimeIdentifier>win-x64</RuntimeIdentifier>
        <PlatformFolder>x64</PlatformFolder>
      </PropertyGroup>
    </When>
    <Otherwise>
      <PropertyGroup>
        <RuntimeIdentifier>win-x86</RuntimeIdentifier>
        <PlatformFolder>x86</PlatformFolder>
      </PropertyGroup>
    </Otherwise>
  </Choose>

  <ItemGroup>
    <PackageReference Include="Microsoft.SourceLink.GitHub" Version="$(MicrosoftSourceLinkVersion)" PrivateAssets="all"/>
  </ItemGroup>
  
  <Import Project="$(MsBuildThisFileDirectory)\Publish.props"/>
  <Import Project="$(MsBuildThisFileDirectory)\StrongName.props"/>

  <ItemDefinitionGroup>
    <EmbeddedResource>
      <GenerateSource>false</GenerateSource>
    </EmbeddedResource>
    
    <PackageReference>
      <PrivateAssets>contentfiles;analyzers;build</PrivateAssets>
    </PackageReference>
  </ItemDefinitionGroup>

  <PropertyGroup>
    <InternalUtilitiesProject>$(WpfTestBasePath)\Infra\TestUtilities\InternalUtilities\InternalUtilities.csproj</InternalUtilitiesProject>
    <TestContractsProject>$(WpfTestBasePath)\Infra\CommunityChest\TestContracts\TestContracts.csproj</TestContractsProject>
    <TestApiCoreProject>$(WpfTestBasePath)\Infra\TestApi\TestApiCore\Code\TestApiCore.csproj</TestApiCoreProject>
    <TestRuntimeProject>$(WpfTestBasePath)\Common\TestRuntime\TestRuntime.csproj</TestRuntimeProject>
    <TestServicesProject>$(WpfTestBasePath)\Common\Drt\TestServices\TestServices.csproj</TestServicesProject>
    <QualityVaultUtilitiesProject>$(WpfTestBasePath)\Infra\QualityVault\QualityVaultUtilities\QualityVaultUtilities.csproj</QualityVaultUtilitiesProject>
    <DrtToolsProject>$(WpfTestBasePath)\Common\DRT\Tools\DrtTools.csproj</DrtToolsProject>
  </PropertyGroup>

  <Import Project="$(MsBuildThisFileDirectory)\SourceLocations.props"/>

  <PropertyGroup>
    <SignAssembly>true</SignAssembly>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <EnableDefaultItems>false</EnableDefaultItems>
  </PropertyGroup>

  <PropertyGroup>
    <!-- CS0618 - UnmanagedType.Struct usage -->
    <!-- VSTHRD002 - Synchronous awaits from IPC since we can't convert the entire logging/IPC mechanism to async -->
    <!-- VSTHRD001 - Legacy sync code -->
    <NoWarn>CS0618;VSTHRD002;VSTHRD001</NoWarn>
    
    <!-- Remove these when open sourcing -->
    <NoWarn>$(NoWarn);CS3005;CS3001;CS3002;CS3003;CS0169</NoWarn>
  </PropertyGroup>
</Project>